<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asesmen dan Refleksi - Asam Basa</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .quiz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .quiz-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .quiz-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .quiz-card p {
            color: #666;
            line-height: 1.6;
        }

        .quiz-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .quiz-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .back-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            margin-bottom: 20px;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: #5568d3;
        }

        .question {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .question h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            padding: 12px 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .option.selected {
            border-color: #667eea;
            background: #e8eeff;
        }

        .option.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        .option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .submit-btn, .check-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            margin-top: 20px;
            transition: background 0.3s;
        }

        .submit-btn:hover, .check-btn:hover {
            background: #218838;
        }

        .submit-btn:disabled, .check-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .retry-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            margin-top: 20px;
            margin-left: 10px;
            transition: background 0.3s;
        }

        .retry-btn:hover {
            background: #5568d3;
        }

        .result {
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .result.show {
            display: block;
        }

        .result h3 {
            color: #28a745;
            margin-bottom: 15px;
        }

        .feedback {
            margin-top: 10px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            border-left: 4px solid #28a745;
        }

        .feedback.incorrect {
            border-left: 4px solid #dc3545;
        }

        .pbl-section {
            margin-bottom: 25px;
        }

        .pbl-step {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #764ba2;
        }

        .pbl-step h4 {
            color: #764ba2;
            margin-bottom: 10px;
        }

        textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1em;
            resize: vertical;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .hint-btn, .answer-btn {
            background: #ffc107;
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-right: 10px;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .hint-btn:hover, .answer-btn:hover {
            background: #e0a800;
        }

        .hint-content, .answer-content {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
            border-left: 4px solid #ffc107;
        }

        .hint-content.show, .answer-content.show {
            display: block;
        }

        .reflection-questions {
            display: grid;
            gap: 20px;
        }

        .reflection-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .reflection-item h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .score-display {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        /* Login Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-content h2 {
            color: #667eea;
            margin-bottom: 25px;
            text-align: center;
        }

        .role-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .role-btn {
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 1.1em;
        }

        .role-btn:hover {
            border-color: #667eea;
            background: #f0f4ff;
            transform: translateY(-2px);
        }

        .role-btn.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .role-btn .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .login-form {
            display: none;
        }

        .login-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background 0.3s;
        }

        .login-btn:hover {
            background: #5568d3;
        }

        .error-message {
            color: #dc3545;
            margin-top: 10px;
            display: none;
            text-align: center;
        }

        .error-message.show {
            display: block;
        }

        /* Teacher Dashboard Styles */
        .teacher-dashboard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .logout-btn:hover {
            background: #c82333;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .student-list {
            margin-top: 20px;
        }

        .student-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .student-name {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
        }

        .student-class {
            color: #666;
            font-size: 0.9em;
        }

        .student-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .score-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .score-item .label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 5px;
        }

        .score-item .value {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .filter-section {
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-section select, .filter-section input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
        }

        .user-info {
            background: #e8eeff;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info-text {
            color: #333;
        }

        .user-info-text strong {
            color: #667eea;
        }

        .reflection-detail {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .reflection-answer {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 3px solid #667eea;
        }

        .reflection-answer .question-text {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .reflection-answer .answer-text {
            color: #666;
            line-height: 1.6;
        }

        .toggle-detail {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .toggle-detail:hover {
            background: #5568d3;
        }

        .reflection-detail {
            display: none;
        }

        .reflection-detail.show {
            display: block;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }
            
            .quiz-grid {
                grid-template-columns: 1fr;
            }
            
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div id="loginModal" class="modal active">
        <div class="modal-content">
            <h2>Selamat Datang di Asesmen & Refleksi Asam-Basa</h2>

            <a href="Modul 1_Landing Page.html" class="home-link" style="display: inline-block; margin-bottom: 20px;">
                ‚Üê Kembali ke Beranda
            </a>
            
            <div class="role-selection">
                <div class="role-btn" onclick="selectRole('student')">
                    <div class="icon">üë®‚Äçüéì</div>
                    <div>Siswa</div>
                </div>
                <div class="role-btn" onclick="selectRole('teacher')">
                    <div class="icon">üë®‚Äçüè´</div>
                    <div>Guru</div>
                </div>
            </div>

            <!-- Student Login Form -->
            <div id="studentForm" class="login-form">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="studentName" placeholder="Masukkan nama Anda">
                </div>
                <div class="form-group">
                    <label>Kelas</label>
                    <input type="text" id="studentClass" placeholder="Contoh: XI IPA 1">
                </div>
                <button class="login-btn" onclick="loginStudent()">Masuk sebagai Siswa</button>
                <div id="studentError" class="error-message">Harap isi nama dan kelas dengan lengkap!</div>
            </div>

            <!-- Teacher Login Form -->
            <div id="teacherForm" class="login-form">
                <div class="form-group">
                    <label>Kode Akses Guru</label>
                    <input type="password" id="teacherCode" placeholder="Masukkan kode akses">
                </div>
                <button class="login-btn" onclick="loginTeacher()">Masuk sebagai Guru</button>
                <div id="teacherError" class="error-message">Kode akses salah!</div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- User Info Bar -->
        <div id="userInfoBar" class="user-info" style="display: none;">
            <div class="user-info-text">
                <span id="userInfoText"></span>
            </div>
            <button class="logout-btn" onclick="logout()">Keluar</button>
        </div>

        <!-- Teacher Dashboard -->
        <div id="teacherDashboard" style="display: none;">
            <div class="teacher-dashboard">
                <div class="dashboard-header">
                    <h2>Dashboard Guru</h2>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="totalStudents">0</h3>
                        <p>Total Siswa</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="avgQuiz1">0%</h3>
                        <p>Rata-rata Kuis 1</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="avgQuiz2">0%</h3>
                        <p>Rata-rata Kuis 2</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="avgQuiz3">0%</h3>
                        <p>Rata-rata Kuis Final</p>
                    </div>
                </div>

                <div class="filter-section">
                    <select id="classFilter" onchange="filterStudents()">
                        <option value="">Semua Kelas</option>
                    </select>
                    <input type="text" id="searchStudent" placeholder="Cari nama siswa..." oninput="filterStudents()">
                    <select id="dataTypeFilter" onchange="filterStudents()">
                        <option value="quiz">Data Kuis</option>
                        <option value="reflection">Data Refleksi</option>
                    </select>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0;">Daftar Hasil Siswa</h3>
                    <button class="logout-btn" onclick="resetAllData()" style="background: #ffc107; color: #333;">
                        üîÑ Reset Semua Data
                    </button>
                </div>
                <div id="studentListContainer" class="student-list"></div>
            </div>
        </div>

        <header id="mainHeader">
            <h1>Asesmen dan Refleksi</h1>
            <p>Uji Pemahaman Anda tentang Asam-Basa</p>
        </header>

        <div id="mainMenu" class="quiz-grid">
            <div class="quiz-card" onclick="showQuiz('quiz1')">
                <h3>üß™ Kuis 1: Klasifikasi Asam-Basa</h3>
                <p>Uji kemampuan mengklasifikasikan zat menjadi asam, basa, atau garam dengan 10 soal pilihan ganda.</p>
            </div>

            <div class="quiz-card" onclick="showQuiz('quiz2')">
                <h3>‚öóÔ∏è Kuis 2: Reaksi Penetralan</h3>
                <p>Latihan menentukan hasil reaksi penetralan asam dan basa dengan 10 soal interaktif.</p>
            </div>

            <div class="quiz-card" onclick="showQuiz('pbl1')">
                <h3>üî¨ PBL 1: Ionisasi Asam-Basa</h3>
                <p>Analisis kasus tentang derajat ionisasi dan kekuatan asam-basa dalam air menggunakan pendekatan PBL.</p>
            </div>

            <div class="quiz-card" onclick="showQuiz('pbl2')">
                <h3>üé® PBL 2: Indikator Asam-Basa</h3>
                <p>Tentukan indikator terbaik untuk berbagai sampel melalui pembelajaran berbasis masalah.</p>
            </div>

            <div class="quiz-card" onclick="showQuiz('quiz3')">
                <h3>üìù Kuis Final</h3>
                <p>Kuis komprehensif dengan 20 soal untuk mengukur pemahaman keseluruhan materi asam-basa.</p>
            </div>

            <div class="quiz-card" onclick="showQuiz('reflection')">
                <h3>üí≠ Refleksi Pembelajaran</h3>
                <p>Renungkan pengalaman belajar Anda dengan 10 pertanyaan reflektif.</p>
            </div>
        </div>

        <!-- Quiz 1: Klasifikasi Asam-Basa -->
        <div id="quiz1" class="quiz-content">
            <button class="back-btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button>
            <h2>Kuis 1: Klasifikasi Asam-Basa</h2>
            <p style="margin-bottom: 20px; color: #666;">Pilih jawaban yang paling tepat untuk setiap pertanyaan.</p>
            
            <div id="quiz1Questions"></div>
            
            <button class="submit-btn" id="submitQuiz1Btn" onclick="submitQuiz1()">Lihat Hasil</button>
            
            <div id="quiz1Result" class="result"></div>
        </div>

        <!-- Quiz 2: Reaksi Penetralan -->
        <div id="quiz2" class="quiz-content">
            <button class="back-btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button>
            <h2>Kuis 2: Reaksi Penetralan</h2>
            <p style="margin-bottom: 20px; color: #666;">Tentukan hasil reaksi penetralan berikut.</p>
            
            <div id="quiz2Questions"></div>
            
            <button class="submit-btn" id="submitQuiz2Btn" onclick="submitQuiz2()">Lihat Hasil</button>
            
            <div id="quiz2Result" class="result"></div>
        </div>

        <!-- PBL 1: Ionisasi Asam-Basa -->
        <div id="pbl1" class="quiz-content">
            <button class="back-btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button>
            <h2>PBL 1: Ionisasi Asam dan Basa dalam Air</h2>
            
            <div class="pbl-step">
                <h4>Langkah 1: Orientasi Masalah</h4>
                <p><strong>Skenario:</strong></p>
                <p>Di laboratorium kimia, seorang analis menemukan dua botol larutan yang labelnya hilang. Ia hanya mengetahui bahwa salah satunya adalah HCl 0,1 M dan yang lainnya adalah CH‚ÇÉCOOH 0,1 M. Ketika diukur dengan pH meter, larutan pertama menunjukkan pH = 1, sedangkan larutan kedua menunjukkan pH = 3. Mengapa terjadi perbedaan pH yang signifikan padahal konsentrasi keduanya sama?</p>
            </div>

            <div class="pbl-step">
                <h4>Langkah 2: Identifikasi Masalah</h4>
                <textarea placeholder="Tuliskan masalah utama yang perlu dipecahkan dari skenario di atas..."></textarea>
            </div>

            <div class="pbl-step">
                <h4>Langkah 3: Pengumpulan Informasi</h4>
                <textarea placeholder="Tuliskan informasi/konsep apa saja yang Anda butuhkan untuk memecahkan masalah ini (derajat ionisasi, Ka, konsentrasi ion, dll)..."></textarea>
                <button class="hint-btn" onclick="toggleHint('pbl1hint1')">Lihat Petunjuk</button>
                <div id="pbl1hint1" class="hint-content">
                    <p><strong>Petunjuk:</strong> Pertimbangkan konsep-konsep berikut:</p>
                    <ul>
                        <li>Derajat ionisasi (Œ±) asam kuat vs asam lemah</li>
                        <li>Hubungan pH dengan konsentrasi ion H‚Å∫</li>
                        <li>Konstanta kesetimbangan asam (Ka)</li>
                        <li>Perbedaan ionisasi sempurna vs ionisasi sebagian</li>
                    </ul>
                </div>
            </div>

            <div class="pbl-step">
                <h4>Langkah 4: Analisis dan Sintesis</h4>
                <textarea placeholder="Analisis perbedaan ionisasi HCl dan CH‚ÇÉCOOH. Jelaskan mengapa pH keduanya berbeda meskipun konsentrasinya sama..."></textarea>
                <button class="hint-btn" onclick="toggleHint('pbl1hint2')">Lihat Petunjuk</button>
                <div id="pbl1hint2" class="hint-content">
                    <p><strong>Petunjuk Analisis:</strong></p>
                    <p>‚Ä¢ HCl adalah asam kuat (Œ± ‚âà 1): HCl ‚Üí H‚Å∫ + Cl‚Åª (sempurna)</p>
                    <p>‚Ä¢ CH‚ÇÉCOOH adalah asam lemah (Œ± << 1): CH‚ÇÉCOOH ‚áå H‚Å∫ + CH‚ÇÉCOO‚Åª (sebagian)</p>
                    <p>‚Ä¢ Bandingkan konsentrasi ion H‚Å∫ yang dihasilkan keduanya</p>
                </div>
            </div>

            <div class="pbl-step">
                <h4>Langkah 5: Solusi dan Kesimpulan</h4>
                <textarea placeholder="Tuliskan kesimpulan lengkap tentang hubungan derajat ionisasi dengan kekuatan asam dan pH larutan..."></textarea>
                <button class="answer-btn" onclick="toggleHint('pbl1answer')">Lihat Jawaban</button>
                <div id="pbl1answer" class="answer-content">
                    <p><strong>Jawaban Lengkap:</strong></p>
                    <p><strong>Analisis:</strong></p>
                    <p>HCl (asam kuat) terionisasi sempurna (Œ± = 1), sehingga [H‚Å∫] = 0,1 M ‚Üí pH = -log(0,1) = 1</p>
                    <p>CH‚ÇÉCOOH (asam lemah) hanya terionisasi sebagian (Œ± << 1), misalnya dengan Ka = 1,8 √ó 10‚Åª‚Åµ:</p>
                    <p>[H‚Å∫] = ‚àö(Ka √ó M) = ‚àö(1,8 √ó 10‚Åª‚Åµ √ó 0,1) = 1,34 √ó 10‚Åª¬≥ M ‚Üí pH ‚âà 3</p>
                    <p><strong>Kesimpulan:</strong></p>
                    <p>Perbedaan pH terjadi karena derajat ionisasi yang berbeda. Asam kuat terionisasi sempurna menghasilkan konsentrasi H‚Å∫ yang tinggi (pH rendah), sedangkan asam lemah hanya terionisasi sebagian menghasilkan konsentrasi H‚Å∫ yang lebih rendah (pH lebih tinggi), meskipun konsentrasi awal sama.</p>
                </div>
            </div>

            <div class="pbl-step">
                <h4>Langkah 6: Evaluasi</h4>
                <textarea placeholder="Refleksikan: Apa implikasi praktis dari perbedaan ini dalam aplikasi sehari-hari atau industri?"></textarea>
            </div>
        </div>

        <!-- PBL 2: Indikator Asam-Basa -->
        <div id="pbl2" class="quiz-content">
            <button class="back-btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button>
            <h2>PBL 2: Indikator Asam-Basa</h2>
            
            <div class="pbl-step">
                <h4>Langkah 1: Orientasi Masalah</h4>
                <p><strong>Skenario:</strong></p>
                <p>Seorang teknisi laboratorium diminta melakukan titrasi asam kuat (HCl) dengan basa kuat (NaOH). Ia memiliki tiga indikator: fenolftalein (trayek pH 8,3-10,0), metil orange (trayek pH 3,1-4,4), dan bromtimol biru (trayek pH 6,0-7,6). Manakah indikator yang paling tepat untuk titrasi ini? Bagaimana jika yang dititrasi adalah asam lemah (CH‚ÇÉCOOH) dengan basa kuat?</p>
            </div>

            <div class="pbl-step">
                <h4>Langkah 2: Identifikasi Masalah</h4>
                <textarea placeholder="Rumuskan masalah: Bagaimana memilih indikator yang tepat untuk berbagai jenis titrasi?"></textarea>
            </div>

            <div class="pbl-step">
                <h4>Langkah 3: Pengumpulan Informasi</h4>
                <textarea placeholder="Tuliskan informasi yang Anda butuhkan: pH titik ekuivalen untuk berbagai jenis titrasi, trayek pH indikator, dll..."></textarea>
                <button class="hint-btn" onclick="toggleHint('pbl2hint1')">Lihat Petunjuk</button>
                <div id="pbl2hint1" class="hint-content">
                    <p><strong>Informasi Penting:</strong></p>
                    <ul>
                        <li>Titrasi asam kuat + basa kuat: pH titik ekuivalen = 7</li>
                        <li>Titrasi asam lemah + basa kuat: pH titik ekuivalen > 7 (8-10)</li>
                        <li>Titrasi asam kuat + basa lemah: pH titik ekuivalen < 7 (3-5)</li>
                        <li>Indikator harus berubah warna di sekitar pH titik ekuivalen</li>
                    </ul>
                </div>
            </div>

            <div class="pbl-step">
                <h4>Langkah 4: Analisis Kasus</h4>
                <p><strong>Kasus 1: Titrasi HCl (asam kuat) + NaOH (basa kuat)</strong></p>
                <textarea placeholder="Analisis: Berapa pH titik ekuivalen? Indikator mana yang cocok?"></textarea>
                
                <p style="margin-top: 15px;"><strong>Kasus 2: Titrasi CH‚ÇÉCOOH (asam lemah) + NaOH (basa kuat)</strong></p>
                <textarea placeholder="Analisis: Berapa pH titik ekuivalen? Indikator mana yang cocok?"></textarea>
                
                <button class="hint-btn" onclick="toggleHint('pbl2hint2')">Lihat Petunjuk</button>
                <div id="pbl2hint2" class="hint-content">
                    <p><strong>Analisis:</strong></p>
                    <p><strong>Kasus 1:</strong> pH titik ekuivalen = 7, maka bromtimol biru (6,0-7,6) atau fenolftalein (8,3-10,0) dapat digunakan.</p>
                    <p><strong>Kasus 2:</strong> pH titik ekuivalen ‚âà 8-9, maka fenolftalein (8,3-10,0) paling cocok.</p>
                </div>
            </div>

            <div class="pbl-step">
                <h4>Langkah 5: Solusi</h4>
                <textarea placeholder="Tuliskan solusi lengkap: Indikator mana untuk titrasi apa, dan mengapa?"></textarea>
                <button class="answer-btn" onclick="toggleHint('pbl2answer')">Lihat Jawaban</button>
                <div id="pbl2answer" class="answer-content">
                    <p><strong>Solusi Lengkap:</strong></p>
                    <p><strong>Untuk HCl + NaOH:</strong></p>
                    <p>Indikator terbaik: Bromtimol biru atau fenolftalein. Titik ekuivalen berada di pH 7, dan kedua indikator ini mencakup rentang tersebut. Metil orange tidak cocok karena trayek terlalu asam (3,1-4,4).</p>
                    <p><strong>Untuk CH‚ÇÉCOOH + NaOH:</strong></p>
                    <p>Indikator terbaik: Fenolftalein. Titik ekuivalen berada di pH 8-9 (karena terbentuk garam bersifat basa), sehingga fenolftalein dengan trayek 8,3-10,0 paling sesuai.</p>
                    <p><strong>Prinsip Umum:</strong> Pilih indikator yang trayek pH-nya mencakup pH titik ekuivalen titrasi.</p>
                </div>
            </div>

            <div class="pbl-step">
                <h4>Langkah 6: Evaluasi dan Refleksi</h4>
                <textarea placeholder="Refleksi: Apa yang terjadi jika memilih indikator yang salah? Berikan contoh dampaknya pada hasil titrasi."></textarea>
            </div>
        </div>

        <!-- Quiz 3: Comprehensive Quiz -->
        <div id="quiz3" class="quiz-content">
            <button class="back-btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button>
            <h2>Kuis Final</h2>
            <p style="margin-bottom: 20px; color: #666;">Kerjakan semua soal dengan teliti.</p>
            
            <div id="quiz3Questions"></div>
            
            <button class="submit-btn" id="submitQuiz3Btn" onclick="submitQuiz3()">Lihat Hasil</button>
            
            <div id="quiz3Result" class="result"></div>
        </div>

        <!-- Reflection -->
        <div id="reflection" class="quiz-content">
            <button class="back-btn" onclick="backToMenu()">‚Üê Kembali ke Menu</button>
            <h2>Refleksi Pembelajaran</h2>
            <p style="margin-bottom: 20px; color: #666;">Renungkan pengalaman belajar Anda dengan menjawab pertanyaan berikut secara jujur dan mendalam.</p>
            
            <div class="reflection-questions">
                <div class="reflection-item">
                    <h4>1. Konsep mana dalam materi asam-basa yang menurut Anda paling sulit dipahami? Mengapa?</h4>
                    <textarea id="reflection1" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>2. Bagaimana pemahaman Anda tentang perbedaan asam kuat dan asam lemah sebelum dan sesudah mempelajari materi ini?</h4>
                    <textarea id="reflection2" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>3. Metode pembelajaran mana yang paling membantu Anda memahami konsep ionisasi? (PBL, kuis interaktif, atau yang lain?)</h4>
                    <textarea id="reflection3" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>4. Apakah Anda dapat menghubungkan materi asam-basa dengan fenomena sehari-hari? Berikan contohnya.</h4>
                    <textarea id="reflection4" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>5. Bagaimana pengalaman Anda mengerjakan soal perhitungan pH? Apakah Anda merasa kesulitan atau sudah lancar?</h4>
                    <textarea id="reflection5" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>6. Apa strategi yang Anda gunakan untuk membedakan indikator yang tepat dalam berbagai jenis titrasi?</h4>
                    <textarea id="reflection6" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>7. Setelah mempelajari materi ini, apakah Anda merasa lebih percaya diri dalam menyelesaikan masalah terkait asam-basa? Jelaskan.</h4>
                    <textarea id="reflection7" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>8. Apa yang akan Anda lakukan untuk meningkatkan pemahaman Anda lebih lanjut tentang topik ini?</h4>
                    <textarea id="reflection8" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>9. Bagaimana materi asam-basa ini dapat Anda aplikasikan dalam kehidupan sehari-hari atau bidang studi lain?</h4>
                    <textarea id="reflection9" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>

                <div class="reflection-item">
                    <h4>10. Apa saran Anda untuk meningkatkan pembelajaran materi asam-basa di masa mendatang?</h4>
                    <textarea id="reflection10" placeholder="Tuliskan refleksi Anda..."></textarea>
                </div>
            </div>

            <button class="submit-btn" id="submitReflectionBtn" onclick="submitReflection()">Kirim Refleksi</button>
            
            <div id="reflectionResult" class="result"></div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let userRole = null;
        const TEACHER_CODE = '162003';

        // Initialize storage
        function initStorage() {
            if (!localStorage.getItem('studentResults')) {
                localStorage.setItem('studentResults', JSON.stringify([]));
            }
        }

        // Role selection
        function selectRole(role) {
            document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.role-btn').classList.add('active');
            
            document.querySelectorAll('.login-form').forEach(form => form.classList.remove('active'));
            
            if (role === 'student') {
                document.getElementById('studentForm').classList.add('active');
            } else {
                document.getElementById('teacherForm').classList.add('active');
            }
        }

        // Login functions
        function loginStudent() {
            const name = document.getElementById('studentName').value.trim();
            const className = document.getElementById('studentClass').value.trim();
            
            if (!name || !className) {
                document.getElementById('studentError').classList.add('show');
                return;
            }
            
            currentUser = { name, class: className, role: 'student' };
            userRole = 'student';
            
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('userInfoBar').style.display = 'flex';
            document.getElementById('userInfoText').innerHTML = `Selamat datang, <strong>${name}</strong> - ${className}`;
            document.getElementById('mainHeader').style.display = 'block';
            document.getElementById('mainMenu').style.display = 'grid';
            
            initStorage();
        }

        function loginTeacher() {
            const code = document.getElementById('teacherCode').value;
            
            if (code !== TEACHER_CODE) {
                document.getElementById('teacherError').classList.add('show');
                return;
            }
            
            currentUser = { role: 'teacher' };
            userRole = 'teacher';
            
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('userInfoBar').style.display = 'flex';
            document.getElementById('userInfoText').innerHTML = `Selamat datang, <strong>Guru</strong>`;
            document.getElementById('mainHeader').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('teacherDashboard').style.display = 'block';
            
            initStorage();
            loadTeacherDashboard();
        }

        function logout() {
            currentUser = null;
            userRole = null;
            
            document.getElementById('loginModal').classList.add('active');
            document.getElementById('userInfoBar').style.display = 'none';
            document.getElementById('teacherDashboard').style.display = 'none';
            document.getElementById('mainHeader').style.display = 'block';
            document.getElementById('mainMenu').style.display = 'grid';
            
            // Reset forms
            document.getElementById('studentName').value = '';
            document.getElementById('studentClass').value = '';
            document.getElementById('teacherCode').value = '';
            document.querySelectorAll('.error-message').forEach(err => err.classList.remove('show'));
            document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.login-form').forEach(form => form.classList.remove('active'));
            
            // Back to main menu if in quiz
            backToMenu();
        }

        // Save student results
        function saveStudentResult(quizType, score, total) {
            if (userRole !== 'student') return;
            
            const results = JSON.parse(localStorage.getItem('studentResults') || '[]');
            
            let studentRecord = results.find(r => 
                r.name === currentUser.name && r.class === currentUser.class
            );
            
            if (!studentRecord) {
                studentRecord = {
                    name: currentUser.name,
                    class: currentUser.class,
                    quiz1: null,
                    quiz2: null,
                    quiz3: null,
                    reflection: null,
                    timestamp: new Date().toISOString()
                };
                results.push(studentRecord);
            }
            
            studentRecord[quizType] = { score, total, percentage: ((score/total)*100).toFixed(0) };
            studentRecord.lastUpdate = new Date().toISOString();
            
            localStorage.setItem('studentResults', JSON.stringify(results));
        }

        // Save reflection
        function saveReflection(answers) {
            if (userRole !== 'student') return;
            
            const results = JSON.parse(localStorage.getItem('studentResults') || '[]');
            
            let studentRecord = results.find(r => 
                r.name === currentUser.name && r.class === currentUser.class
            );
            
            if (!studentRecord) {
                studentRecord = {
                    name: currentUser.name,
                    class: currentUser.class,
                    quiz1: null,
                    quiz2: null,
                    quiz3: null,
                    reflection: null,
                    timestamp: new Date().toISOString()
                };
                results.push(studentRecord);
            }
            
            studentRecord.reflection = {
                answers: answers,
                submittedAt: new Date().toISOString()
            };
            studentRecord.lastUpdate = new Date().toISOString();
            
            localStorage.setItem('studentResults', JSON.stringify(results));
        }

        // Submit reflection
        function submitReflection() {
            const answers = [];
            let allFilled = true;
            
            for (let i = 1; i <= 10; i++) {
                const answer = document.getElementById(`reflection${i}`).value.trim();
                if (!answer) {
                    allFilled = false;
                }
                answers.push(answer);
            }
            
            if (!allFilled) {
                alert('Harap isi semua pertanyaan refleksi sebelum mengirim!');
                return;
            }
            
            saveReflection(answers);
            
            const result = document.getElementById('reflectionResult');
            result.className = 'result show';
            result.innerHTML = `
                <h3>‚úì Refleksi Berhasil Dikirim!</h3>
                <p>Terima kasih telah mengisi refleksi pembelajaran. Jawaban Anda telah tersimpan.</p>
            `;
            
            document.getElementById('submitReflectionBtn').disabled = true;
            
            // Disable all textareas
            for (let i = 1; i <= 10; i++) {
                document.getElementById(`reflection${i}`).disabled = true;
            }
        }

        // Load teacher dashboard
        function loadTeacherDashboard() {
            const results = JSON.parse(localStorage.getItem('studentResults') || '[]');
            
            if (results.length === 0) {
                document.getElementById('studentListContainer').innerHTML = 
                    '<p style="text-align: center; color: #666; padding: 40px;">Belum ada siswa yang mengerjakan kuis.</p>';
                return;
            }
            
            // Calculate statistics
            document.getElementById('totalStudents').textContent = results.length;
            
            const quiz1Scores = results.filter(r => r.quiz1).map(r => parseInt(r.quiz1.percentage));
            const quiz2Scores = results.filter(r => r.quiz2).map(r => parseInt(r.quiz2.percentage));
            const quiz3Scores = results.filter(r => r.quiz3).map(r => parseInt(r.quiz3.percentage));
            
            document.getElementById('avgQuiz1').textContent = 
                quiz1Scores.length > 0 ? Math.round(quiz1Scores.reduce((a,b) => a+b, 0) / quiz1Scores.length) + '%' : '-';
            document.getElementById('avgQuiz2').textContent = 
                quiz2Scores.length > 0 ? Math.round(quiz2Scores.reduce((a,b) => a+b, 0) / quiz2Scores.length) + '%' : '-';
            document.getElementById('avgQuiz3').textContent = 
                quiz3Scores.length > 0 ? Math.round(quiz3Scores.reduce((a,b) => a+b, 0) / quiz3Scores.length) + '%' : '-';
            
            // Populate class filter
            const classes = [...new Set(results.map(r => r.class))];
            const classFilter = document.getElementById('classFilter');
            classFilter.innerHTML = '<option value="">Semua Kelas</option>' + 
                classes.map(c => `<option value="${c}">${c}</option>`).join('');
            
            // Display student list
            displayStudents(results);
        }

        const reflectionQuestions = [
            "Konsep mana dalam materi asam-basa yang menurut Anda paling sulit dipahami? Mengapa?",
            "Bagaimana pemahaman Anda tentang perbedaan asam kuat dan asam lemah sebelum dan sesudah mempelajari materi ini?",
            "Metode pembelajaran mana yang paling membantu Anda memahami konsep ionisasi? (PBL, kuis interaktif, atau yang lain?)",
            "Apakah Anda dapat menghubungkan materi asam-basa dengan fenomena sehari-hari? Berikan contohnya.",
            "Bagaimana pengalaman Anda mengerjakan soal perhitungan pH? Apakah Anda merasa kesulitan atau sudah lancar?",
            "Apa strategi yang Anda gunakan untuk membedakan indikator yang tepat dalam berbagai jenis titrasi?",
            "Setelah mempelajari materi ini, apakah Anda merasa lebih percaya diri dalam menyelesaikan masalah terkait asam-basa? Jelaskan.",
            "Apa yang akan Anda lakukan untuk meningkatkan pemahaman Anda lebih lanjut tentang topik ini?",
            "Bagaimana materi asam-basa ini dapat Anda aplikasikan dalam kehidupan sehari-hari atau bidang studi lain?",
            "Apa saran Anda untuk meningkatkan pembelajaran materi asam-basa di masa mendatang?"
        ];

        function displayStudents(results) {
            const container = document.getElementById('studentListContainer');
            const dataType = document.getElementById('dataTypeFilter').value;
            
            if (dataType === 'quiz') {
                container.innerHTML = results.map(student => `
                    <div class="student-item">
                        <div class="student-header">
                            <div>
                                <div class="student-name">${student.name}</div>
                                <div class="student-class">${student.class}</div>
                            </div>
                            <div style="text-align: right; color: #666; font-size: 0.85em;">
                                ${new Date(student.lastUpdate || student.timestamp).toLocaleString('id-ID')}
                            </div>
                        </div>
                        <div class="student-scores">
                            <div class="score-item">
                                <div class="label">Kuis 1</div>
                                <div class="value">${student.quiz1 ? `${student.quiz1.score}/${student.quiz1.total}` : '-'}</div>
                                ${student.quiz1 ? `<div style="font-size: 0.9em; color: #666;">(${student.quiz1.percentage}%)</div>` : ''}
                            </div>
                            <div class="score-item">
                                <div class="label">Kuis 2</div>
                                <div class="value">${student.quiz2 ? `${student.quiz2.score}/${student.quiz2.total}` : '-'}</div>
                                ${student.quiz2 ? `<div style="font-size: 0.9em; color: #666;">(${student.quiz2.percentage}%)</div>` : ''}
                            </div>
                            <div class="score-item">
                                <div class="label">Kuis Final</div>
                                <div class="value">${student.quiz3 ? `${student.quiz3.score}/${student.quiz3.total}` : '-'}</div>
                                ${student.quiz3 ? `<div style="font-size: 0.9em; color: #666;">(${student.quiz3.percentage}%)</div>` : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
            } else {
                // Display reflection data
                container.innerHTML = results.map((student, idx) => `
                    <div class="student-item">
                        <div class="student-header">
                            <div>
                                <div class="student-name">${student.name}</div>
                                <div class="student-class">${student.class}</div>
                            </div>
                            <div style="text-align: right; color: #666; font-size: 0.85em;">
                                ${student.reflection ? 'Sudah mengisi refleksi' : 'Belum mengisi refleksi'}
                            </div>
                        </div>
                        ${student.reflection ? `
                            <button class="toggle-detail" onclick="toggleReflection(${idx})">
                                üìù Lihat Jawaban Refleksi
                            </button>
                            <div id="reflection-detail-${idx}" class="reflection-detail">
                                ${student.reflection.answers.map((answer, i) => `
                                    <div class="reflection-answer">
                                        <div class="question-text">${i + 1}. ${reflectionQuestions[i]}</div>
                                        <div class="answer-text">${answer || '<em style="color: #999;">Tidak ada jawaban</em>'}</div>
                                    </div>
                                `).join('')}
                                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e0e0; color: #666; font-size: 0.9em;">
                                    Dikirim pada: ${new Date(student.reflection.submittedAt).toLocaleString('id-ID')}
                                </div>
                            </div>
                        ` : '<p style="margin-top: 10px; color: #999; font-style: italic;">Siswa belum mengisi refleksi</p>'}
                    </div>
                `).join('');
            }
        }

        function toggleReflection(index) {
            const detail = document.getElementById(`reflection-detail-${index}`);
            detail.classList.toggle('show');
        }

        function resetAllData() {
            if (confirm('‚ö†Ô∏è PERHATIAN!\n\nAnda akan menghapus SEMUA data siswa (kuis dan refleksi).\nTindakan ini tidak dapat dibatalkan!\n\nApakah Anda yakin ingin melanjutkan?')) {
                localStorage.removeItem('studentResults');
                initStorage();
                loadTeacherDashboard();
                alert('‚úì Semua data berhasil dihapus!');
            }
        }

        function filterStudents() {
            const results = JSON.parse(localStorage.getItem('studentResults') || '[]');
            const classFilter = document.getElementById('classFilter').value;
            const searchText = document.getElementById('searchStudent').value.toLowerCase();
            
            let filtered = results;
            
            if (classFilter) {
                filtered = filtered.filter(r => r.class === classFilter);
            }
            
            if (searchText) {
                filtered = filtered.filter(r => r.name.toLowerCase().includes(searchText));
            }
            
            displayStudents(filtered);
        }

        // Data for Quiz 1: Klasifikasi Asam-Basa
        const quiz1Data = [
            {
                question: "HCl termasuk dalam kategori...",
                options: ["Asam", "Basa", "Garam", "Netral"],
                correct: 0,
                explanation: "HCl (asam klorida) adalah asam kuat yang melepaskan ion H‚Å∫ dalam larutan."
            },
            {
                question: "NaOH termasuk dalam kategori...",
                options: ["Asam", "Basa", "Garam", "Oksida"],
                correct: 1,
                explanation: "NaOH (natrium hidroksida) adalah basa kuat yang melepaskan ion OH‚Åª dalam larutan."
            },
            {
                question: "NaCl termasuk dalam kategori...",
                options: ["Asam", "Basa", "Garam", "Oksida"],
                correct: 2,
                explanation: "NaCl (natrium klorida) adalah garam yang terbentuk dari reaksi asam kuat (HCl) dan basa kuat (NaOH)."
            },
            {
                question: "CH‚ÇÉCOOH (asam asetat) termasuk dalam kategori...",
                options: ["Asam kuat", "Asam lemah", "Basa lemah", "Garam"],
                correct: 1,
                explanation: "CH‚ÇÉCOOH adalah asam lemah yang hanya terionisasi sebagian dalam larutan."
            },
            {
                question: "NH‚ÇÉ (amonia) termasuk dalam kategori...",
                options: ["Asam kuat", "Asam lemah", "Basa lemah", "Basa kuat"],
                correct: 2,
                explanation: "NH‚ÇÉ adalah basa lemah yang menerima proton (H‚Å∫) dalam larutan membentuk NH‚ÇÑ‚Å∫."
            },
            {
                question: "H‚ÇÇSO‚ÇÑ (asam sulfat) termasuk dalam kategori...",
                options: ["Asam lemah", "Asam kuat", "Basa kuat", "Garam"],
                correct: 1,
                explanation: "H‚ÇÇSO‚ÇÑ adalah asam kuat yang terionisasi sempurna dalam larutan menghasilkan ion H‚Å∫."
            },
            {
                question: "Ca(OH)‚ÇÇ termasuk dalam kategori...",
                options: ["Asam", "Basa", "Garam", "Oksida"],
                correct: 1,
                explanation: "Ca(OH)‚ÇÇ (kalsium hidroksida) adalah basa yang melepaskan ion OH‚Åª dalam larutan."
            },
            {
                question: "K‚ÇÇSO‚ÇÑ termasuk dalam kategori...",
                options: ["Asam", "Basa", "Garam", "Oksida"],
                correct: 2,
                explanation: "K‚ÇÇSO‚ÇÑ (kalium sulfat) adalah garam yang terbentuk dari reaksi basa kuat dan asam kuat."
            },
            {
                question: "HNO‚ÇÉ (asam nitrat) termasuk dalam kategori...",
                options: ["Asam lemah", "Basa lemah", "Asam kuat", "Garam"],
                correct: 2,
                explanation: "HNO‚ÇÉ adalah asam kuat yang terionisasi sempurna dalam air."
            },
            {
                question: "NH‚ÇÑCl termasuk dalam kategori...",
                options: ["Asam", "Basa", "Garam", "Netral"],
                correct: 2,
                explanation: "NH‚ÇÑCl (amonium klorida) adalah garam yang terbentuk dari reaksi basa lemah (NH‚ÇÉ) dengan asam kuat (HCl)."
            }
        ];

        // Data for Quiz 2: Reaksi Penetralan
        const quiz2Data = [
            {
                question: "HCl + NaOH ‚Üí ... + ...",
                options: ["NaCl + H‚ÇÇO", "NaClO + H‚ÇÇ", "NaOH + HCl", "Na‚ÇÇO + HCl‚ÇÇ"],
                correct: 0,
                explanation: "Reaksi penetralan: HCl + NaOH ‚Üí NaCl + H‚ÇÇO (garam + air)"
            },
            {
                question: "H‚ÇÇSO‚ÇÑ + 2KOH ‚Üí ... + ...",
                options: ["K‚ÇÇSO‚ÇÉ + H‚ÇÇO", "K‚ÇÇSO‚ÇÑ + 2H‚ÇÇO", "KSO‚ÇÑ + H‚ÇÇO", "K‚ÇÇS + 2H‚ÇÇO‚ÇÇ"],
                correct: 1,
                explanation: "H‚ÇÇSO‚ÇÑ + 2KOH ‚Üí K‚ÇÇSO‚ÇÑ + 2H‚ÇÇO. Asam sulfat bereaksi dengan 2 mol kalium hidroksida."
            },
            {
                question: "HNO‚ÇÉ + Ca(OH)‚ÇÇ ‚Üí ... + ...",
                options: ["CaNO‚ÇÉ + H‚ÇÇO", "Ca(NO‚ÇÉ)‚ÇÇ + H‚ÇÇO", "2HNO‚ÇÉ + Ca(OH)‚ÇÇ ‚Üí Ca(NO‚ÇÉ)‚ÇÇ + 2H‚ÇÇO", "CaO + HNO‚ÇÑ"],
                correct: 2,
                explanation: "Persamaan lengkap: 2HNO‚ÇÉ + Ca(OH)‚ÇÇ ‚Üí Ca(NO‚ÇÉ)‚ÇÇ + 2H‚ÇÇO (setara 1:1 untuk OH‚Åª dan H‚Å∫)"
            },
            {
                question: "CH‚ÇÉCOOH + NaOH ‚Üí ... + ...",
                options: ["CH‚ÇÉCOONa + H‚ÇÇO", "CH‚ÇÉNa + COOH‚ÇÇO", "NaCOOH + CH‚ÇÑO", "CH‚ÇÉOH + NaCOO"],
                correct: 0,
                explanation: "CH‚ÇÉCOOH + NaOH ‚Üí CH‚ÇÉCOONa + H‚ÇÇO. Asam asetat bereaksi dengan natrium hidroksida membentuk natrium asetat."
            },
            {
                question: "H‚ÇÉPO‚ÇÑ + 3NaOH ‚Üí ... + ...",
                options: ["NaPO‚ÇÑ + H‚ÇÇO", "Na‚ÇÉPO‚ÇÑ + 3H‚ÇÇO", "Na‚ÇÉP + 4H‚ÇÇO", "NaH‚ÇÇPO‚ÇÑ + 2H‚ÇÇO"],
                correct: 1,
                explanation: "H‚ÇÉPO‚ÇÑ + 3NaOH ‚Üí Na‚ÇÉPO‚ÇÑ + 3H‚ÇÇO. Asam fosfat (trivalen) membutuhkan 3 mol NaOH."
            },
            {
                question: "HBr + KOH ‚Üí ... + ...",
                options: ["KBr + H‚ÇÇO", "KBrO + H‚ÇÇ", "K‚ÇÇBr + H‚ÇÇO‚ÇÇ", "BrK + OH‚ÇÇ"],
                correct: 0,
                explanation: "HBr + KOH ‚Üí KBr + H‚ÇÇO. Asam bromida bereaksi dengan kalium hidroksida."
            },
            {
                question: "2HCl + Mg(OH)‚ÇÇ ‚Üí ... + ...",
                options: ["MgCl + 2H‚ÇÇO", "MgCl‚ÇÇ + 2H‚ÇÇO", "Mg‚ÇÇCl + H‚ÇÇO", "MgO + 2HCl"],
                correct: 1,
                explanation: "2HCl + Mg(OH)‚ÇÇ ‚Üí MgCl‚ÇÇ + 2H‚ÇÇO. Magnesium hidroksida adalah basa divalen."
            },
            {
                question: "HCOOH + NH‚ÇÉ ‚Üí ... + ...",
                options: ["HCOONH‚ÇÑ", "NH‚ÇÑCOOH", "HCOO + NH‚ÇÑ", "HCOONH‚ÇÇ + H‚ÇÇ"],
                correct: 0,
                explanation: "HCOOH + NH‚ÇÉ ‚Üí HCOONH‚ÇÑ (amonium format). Reaksi asam format dengan amonia."
            },
            {
                question: "H‚ÇÇCO‚ÇÉ + 2NaOH ‚Üí ... + ...",
                options: ["Na‚ÇÇCO‚ÇÉ + 2H‚ÇÇO", "NaCO‚ÇÉ + H‚ÇÇO", "Na‚ÇÇCO‚ÇÇ + 2H‚ÇÇO", "2NaCO + 2H‚ÇÇO"],
                correct: 0,
                explanation: "H‚ÇÇCO‚ÇÉ + 2NaOH ‚Üí Na‚ÇÇCO‚ÇÉ + 2H‚ÇÇO. Asam karbonat bereaksi dengan 2 mol NaOH membentuk natrium karbonat."
            },
            {
                question: "HClO‚ÇÑ + LiOH ‚Üí ... + ...",
                options: ["LiClO‚ÇÑ + H‚ÇÇO", "LiCl + HO‚ÇÖ", "LiClO + H‚ÇÇO‚ÇÇ", "Li‚ÇÇClO‚ÇÑ + 2H‚ÇÇO"],
                correct: 0,
                explanation: "HClO‚ÇÑ + LiOH ‚Üí LiClO‚ÇÑ + H‚ÇÇO. Asam perklorat bereaksi dengan litium hidroksida membentuk litium perklorat."
            }
        ];

        // Data for Quiz 3: Comprehensive Quiz C1-C5
        const quiz3Data = [
            // C1 - Pengetahuan (5 soal)
            {
                question: "Definisi asam kuat yang paling tepat adalah...",
                options: [
                    "Asam yang memiliki pH < 3",
                    "Asam yang terionisasi sempurna dalam larutan",
                    "Asam yang dapat melarutkan logam",
                    "Asam yang memiliki konsentrasi tinggi"
                ],
                correct: 1,
                explanation: "Asam kuat adalah asam yang terionisasi sempurna (Œ± ‚âà 1) dalam larutan air, melepaskan semua ion H‚Å∫.",
                level: "C1"
            },
            {
                question: "Basa lemah didefinisikan sebagai...",
                options: [
                    "Basa yang memiliki pH 8-10",
                    "Basa yang terionisasi sebagian dalam larutan",
                    "Basa yang memiliki konsentrasi rendah",
                    "Basa yang tidak berbahaya"
                ],
                correct: 1,
                explanation: "Basa lemah adalah basa yang hanya terionisasi sebagian (Œ± < 1) dalam larutan, tidak melepaskan semua ion OH‚Åª.",
                level: "C1"
            },
            {
                question: "Derajat ionisasi (Œ±) adalah...",
                options: [
                    "Perbandingan jumlah mol yang terionisasi dengan mol awal",
                    "Kekuatan asam dalam larutan",
                    "Konsentrasi ion H‚Å∫ dalam larutan",
                    "Nilai pH larutan"
                ],
                correct: 0,
                explanation: "Derajat ionisasi (Œ±) = jumlah mol terionisasi / jumlah mol mula-mula. Untuk asam kuat Œ± ‚âà 1, untuk asam lemah Œ± < 1.",
                level: "C1"
            },
            {
                question: "Contoh asam lemah adalah...",
                options: ["HCl", "H‚ÇÇSO‚ÇÑ", "CH‚ÇÉCOOH", "HNO‚ÇÉ"],
                correct: 2,
                explanation: "CH‚ÇÉCOOH (asam asetat) adalah asam lemah. HCl, H‚ÇÇSO‚ÇÑ, dan HNO‚ÇÉ adalah asam kuat.",
                level: "C1"
            },
            {
                question: "Contoh basa kuat adalah...",
                options: ["NH‚ÇÉ", "Al(OH)‚ÇÉ", "NaOH", "Fe(OH)‚ÇÇ"],
                correct: 2,
                explanation: "NaOH (natrium hidroksida) adalah basa kuat. NH‚ÇÉ, Al(OH)‚ÇÉ, dan Fe(OH)‚ÇÇ adalah basa lemah.",
                level: "C1"
            },
            
            // C2 - Pemahaman (6 soal)
            {
                question: "Perbedaan utama antara asam kuat dan asam lemah adalah...",
                options: [
                    "Asam kuat memiliki konsentrasi lebih tinggi",
                    "Asam kuat terionisasi sempurna, asam lemah terionisasi sebagian",
                    "Asam kuat selalu berbahaya, asam lemah aman",
                    "Asam kuat memiliki pH < 3, asam lemah pH > 3"
                ],
                correct: 1,
                explanation: "Perbedaan utama terletak pada derajat ionisasi. Asam kuat terionisasi sempurna menghasilkan lebih banyak ion H‚Å∫, sedangkan asam lemah hanya terionisasi sebagian.",
                level: "C2"
            },
            {
                question: "Mengapa dua larutan asam dengan konsentrasi sama dapat memiliki pH berbeda?",
                options: [
                    "Karena perbedaan suhu larutan",
                    "Karena perbedaan derajat ionisasi",
                    "Karena perbedaan tekanan",
                    "Karena perbedaan volume"
                ],
                correct: 1,
                explanation: "pH berbeda karena derajat ionisasi berbeda. Asam kuat menghasilkan lebih banyak ion H‚Å∫ (pH lebih rendah) daripada asam lemah dengan konsentrasi sama.",
                level: "C2"
            },
            {
                question: "Hubungan antara derajat ionisasi dengan konsentrasi ion H‚Å∫ adalah...",
                options: [
                    "Semakin besar derajat ionisasi, semakin tinggi [H‚Å∫]",
                    "Semakin kecil derajat ionisasi, semakin tinggi [H‚Å∫]",
                    "Derajat ionisasi tidak mempengaruhi [H‚Å∫]",
                    "Hubungannya berbanding terbalik"
                ],
                correct: 0,
                explanation: "Semakin besar derajat ionisasi (mendekati 1), semakin banyak molekul yang terurai menjadi ion H‚Å∫, sehingga [H‚Å∫] semakin tinggi dan pH semakin rendah.",
                level: "C2"
            },
            {
                question: "Jelaskan mengapa larutan NH‚ÇÉ memiliki pH basa meskipun tidak mengandung ion OH‚Åª secara langsung.",
                options: [
                    "NH‚ÇÉ melepaskan ion OH‚Åª saat dilarutkan",
                    "NH‚ÇÉ menerima proton dari air, menghasilkan ion OH‚Åª",
                    "NH‚ÇÉ mengubah air menjadi basa",
                    "NH‚ÇÉ tidak membuat larutan basa"
                ],
                correct: 1,
                explanation: "NH‚ÇÉ + H‚ÇÇO ‚áå NH‚ÇÑ‚Å∫ + OH‚Åª. Amonia menerima proton dari air, menghasilkan ion OH‚Åª yang membuat larutan bersifat basa.",
                level: "C2"
            },
            {
                question: "Apa yang terjadi pada konsentrasi ion H‚Å∫ ketika asam lemah diencerkan?",
                options: [
                    "Konsentrasi H‚Å∫ meningkat karena Œ± meningkat",
                    "Konsentrasi H‚Å∫ berkurang meskipun Œ± meningkat",
                    "Konsentrasi H‚Å∫ tetap sama",
                    "Konsentrasi H‚Å∫ menjadi nol"
                ],
                correct: 1,
                explanation: "Pengenceran meningkatkan derajat ionisasi (Œ±), tetapi konsentrasi total asam berkurang lebih besar, sehingga [H‚Å∫] akhir tetap berkurang dan pH meningkat.",
                level: "C2"
            },
            {
                question: "Mengapa garam dari asam lemah dan basa kuat bersifat basa?",
                options: [
                    "Karena ion dari basa kuat terhidrolisis",
                    "Karena ion dari asam lemah terhidrolisis menghasilkan OH‚Åª",
                    "Karena reaksi penetralan tidak sempurna",
                    "Karena konsentrasi basa lebih besar"
                ],
                correct: 1,
                explanation: "Ion dari asam lemah (misalnya CH‚ÇÉCOO‚Åª) terhidrolisis: CH‚ÇÉCOO‚Åª + H‚ÇÇO ‚áå CH‚ÇÉCOOH + OH‚Åª, menghasilkan ion OH‚Åª sehingga larutan bersifat basa.",
                level: "C2"
            },

            // C3 - Aplikasi/Perhitungan (7 soal)
            {
                question: "Hitung pH larutan HCl 0,01 M (asam kuat).",
                type: "input",
                correct: "2",
                explanation: "pH = -log[H‚Å∫] = -log(0,01) = -log(10‚Åª¬≤) = 2",
                level: "C3"
            },
            {
                question: "Larutan NaOH 0,001 M memiliki pH...",
                type: "input",
                correct: "11",
                explanation: "[OH‚Åª] = 0,001 = 10‚Åª¬≥ M; pOH = -log(10‚Åª¬≥) = 3; pH = 14 - 3 = 11",
                level: "C3"
            },
            {
                question: "Jika Ka CH‚ÇÉCOOH = 1,8 √ó 10‚Åª‚Åµ, hitung pH larutan CH‚ÇÉCOOH 0,1 M. (Bulatkan 1 desimal)",
                type: "input",
                correct: "2.9",
                explanation: "[H‚Å∫] = ‚àö(Ka √ó M) = ‚àö(1,8 √ó 10‚Åª‚Åµ √ó 0,1) = ‚àö(1,8 √ó 10‚Åª‚Å∂) = 1,34 √ó 10‚Åª¬≥; pH = -log(1,34 √ó 10‚Åª¬≥) ‚âà 2,9",
                level: "C3"
            },
            {
                question: "Hitung pOH larutan Ca(OH)‚ÇÇ 0,005 M (basa kuat, terionisasi sempurna).",
                type: "input",
                correct: "2",
                explanation: "Ca(OH)‚ÇÇ ‚Üí Ca¬≤‚Å∫ + 2OH‚Åª; [OH‚Åª] = 2 √ó 0,005 = 0,01 = 10‚Åª¬≤; pOH = -log(10‚Åª¬≤) = 2",
                level: "C3"
            },
            {
                question: "Larutan H‚ÇÇSO‚ÇÑ 0,0001 M memiliki pH... (H‚ÇÇSO‚ÇÑ asam kuat divalen)",
                type: "input",
                correct: "3.7",
                explanation: "H‚ÇÇSO‚ÇÑ ‚Üí 2H‚Å∫ + SO‚ÇÑ¬≤‚Åª; [H‚Å∫] = 2 √ó 0,0001 = 0,0002 = 2 √ó 10‚Åª‚Å¥; pH = -log(2 √ó 10‚Åª‚Å¥) ‚âà 3,7",
                level: "C3"
            },
            {
                question: "Jika Kb NH‚ÇÉ = 1,8 √ó 10‚Åª‚Åµ, hitung pOH larutan NH‚ÇÉ 0,1 M. (Bulatkan 1 desimal)",
                type: "input",
                correct: "2.9",
                explanation: "[OH‚Åª] = ‚àö(Kb √ó M) = ‚àö(1,8 √ó 10‚Åª‚Åµ √ó 0,1) = 1,34 √ó 10‚Åª¬≥; pOH = -log(1,34 √ó 10‚Åª¬≥) ‚âà 2,9",
                level: "C3"
            },
            {
                question: "Berapa volume NaOH 0,1 M yang diperlukan untuk menetralkan 50 mL HCl 0,2 M? (dalam mL)",
                type: "input",
                correct: "100",
                explanation: "M‚ÇÅV‚ÇÅ = M‚ÇÇV‚ÇÇ; 0,2 √ó 50 = 0,1 √ó V‚ÇÇ; V‚ÇÇ = 100 mL",
                level: "C3"
            },

            // C4 - Analisis (1 soal)
            {
                question: "Dalam percobaan virtual lab, tiga indikator diuji pada larutan dengan pH 5. Metil merah (trayek 4,4-6,2) berubah menjadi kuning, bromtimol biru (trayek 6,0-7,6) tetap kuning, dan fenolftalein (trayek 8,3-10,0) tetap tidak berwarna. Indikator manakah yang PALING SENSITIF untuk membedakan asam lemah (pH 5) dari asam kuat (pH 2)?",
                options: [
                    "Metil merah, karena berubah warna di pH 5",
                    "Bromtimol biru, karena trayek mencakup pH netral",
                    "Fenolftalein, karena paling sering digunakan",
                    "Metil merah, karena trayek mencakup pH asam lemah dan kuat"
                ],
                correct: 3,
                explanation: "Metil merah (4,4-6,2) paling sensitif karena trayeknya mencakup rentang pH asam lemah (4-6) dan berada di dekat pH asam kuat (2-3), sehingga dapat membedakan keduanya dengan perubahan warna yang jelas. Bromtimol biru terlalu tinggi, fenolftalein untuk pH basa.",
                level: "C4"
            },

            // C5 - Evaluasi (1 soal)
            {
                question: "Sebuah pabrik memerlukan asam untuk membersihkan pipa logam. Tersedia HCl pekat (asam kuat) dan CH‚ÇÉCOOH pekat (asam lemah) dengan harga sama. Evaluasi pilihan terbaik dengan mempertimbangkan efektivitas, keamanan pekerja, dan dampak terhadap pipa.",
                options: [
                    "HCl, karena lebih kuat dan cepat membersihkan",
                    "CH‚ÇÉCOOH, karena lebih aman meskipun lebih lambat",
                    "HCl, karena lebih murah dan efisien",
                    "Campuran keduanya untuk hasil optimal"
                ],
                correct: 1,
                explanation: "CH‚ÇÉCOOH (asam asetat) lebih tepat karena: (1) Cukup efektif membersihkan deposit tanpa merusak pipa berlebihan, (2) Lebih aman bagi pekerja (tidak menghasilkan uap korosif seperti HCl), (3) Risiko korosi berlebihan pada pipa lebih rendah. HCl meski lebih cepat, terlalu korosif dan berbahaya. Dalam industri, keamanan dan keberlanjutan lebih penting daripada kecepatan semata.",
                level: "C5"
            }
        ];

        // Initialize Quiz 1
        function initQuiz1() {
            const container = document.getElementById('quiz1Questions');
            container.innerHTML = quiz1Data.map((q, index) => `
                <div class="question" data-index="${index}">
                    <h4>Soal ${index + 1}</h4>
                    <p>${q.question}</p>
                    <div class="options">
                        ${q.options.map((opt, i) => `
                            <div class="option" onclick="selectOption1(${index}, ${i})">${opt}</div>
                        `).join('')}
                    </div>
                    <div id="feedback1-${index}" class="feedback"></div>
                </div>
            `).join('');
        }

        let quiz1Answers = [];
        function selectOption1(qIndex, optIndex) {
            const question = document.querySelectorAll('#quiz1Questions .question')[qIndex];
            const options = question.querySelectorAll('.option');
            
            options.forEach(opt => opt.classList.remove('selected'));
            options[optIndex].classList.add('selected');
            
            quiz1Answers[qIndex] = optIndex;
        }

        function submitQuiz1() {
            let correct = 0;
            quiz1Data.forEach((q, index) => {
                const question = document.querySelectorAll('#quiz1Questions .question')[index];
                const options = question.querySelectorAll('.option');
                const feedback = document.getElementById(`feedback1-${index}`);
                
                options.forEach((opt, i) => {
                    opt.style.pointerEvents = 'none';
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else if (i === quiz1Answers[index]) {
                        opt.classList.add('incorrect');
                    }
                });
                
                if (quiz1Answers[index] === q.correct) {
                    correct++;
                    feedback.className = 'feedback show correct';
                    feedback.innerHTML = `<strong>‚úì Benar!</strong> ${q.explanation}`;
                } else {
                    feedback.className = 'feedback show incorrect';
                    feedback.innerHTML = `<strong>‚úó Salah.</strong> ${q.explanation}`;
                }
            });
            
            const result = document.getElementById('quiz1Result');
            result.className = 'result show';
            result.innerHTML = `
                <h3>Hasil Kuis</h3>
                <div class="score-display">Skor Anda: ${correct}/10 (${(correct/10*100).toFixed(0)}%)</div>
                <p>${correct >= 8 ? 'Sempurna! Anda sangat memahami klasifikasi asam-basa.' : 
                     correct >= 6 ? 'Bagus! Terus tingkatkan pemahaman Anda.' : 
                     'Perlu belajar lebih lanjut. Ulangi materi klasifikasi asam-basa.'}</p>
                <button class="retry-btn" onclick="retryQuiz1()">üîÑ Ulangi Kuis</button>
            `;
            
            document.getElementById('submitQuiz1Btn').disabled = true;
            
            // Save result for student
            saveStudentResult('quiz1', correct, 10);
        }

        function retryQuiz1() {
            quiz1Answers = [];
            document.getElementById('quiz1Result').classList.remove('show');
            document.getElementById('submitQuiz1Btn').disabled = false;
            
            document.querySelectorAll('#quiz1Questions .question').forEach((question, index) => {
                const options = question.querySelectorAll('.option');
                const feedback = document.getElementById(`feedback1-${index}`);
                
                options.forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                    opt.style.pointerEvents = 'auto';
                });
                
                feedback.classList.remove('show');
            });
            
            window.scrollTo({top: document.getElementById('quiz1').offsetTop - 20, behavior: 'smooth'});
        }

        // Initialize Quiz 2
        function initQuiz2() {
            const container = document.getElementById('quiz2Questions');
            container.innerHTML = quiz2Data.map((q, index) => `
                <div class="question" data-index="${index}">
                    <h4>Soal ${index + 1}</h4>
                    <p>${q.question}</p>
                    <div class="options">
                        ${q.options.map((opt, i) => `
                            <div class="option" onclick="selectOption2(${index}, ${i})">${opt}</div>
                        `).join('')}
                    </div>
                    <div id="feedback2-${index}" class="feedback"></div>
                </div>
            `).join('');
        }

        let quiz2Answers = [];
        function selectOption2(qIndex, optIndex) {
            const question = document.querySelectorAll('#quiz2Questions .question')[qIndex];
            const options = question.querySelectorAll('.option');
            
            options.forEach(opt => opt.classList.remove('selected'));
            options[optIndex].classList.add('selected');
            
            quiz2Answers[qIndex] = optIndex;
        }

        function submitQuiz2() {
            let correct = 0;
            quiz2Data.forEach((q, index) => {
                const question = document.querySelectorAll('#quiz2Questions .question')[index];
                const options = question.querySelectorAll('.option');
                const feedback = document.getElementById(`feedback2-${index}`);
                
                options.forEach((opt, i) => {
                    opt.style.pointerEvents = 'none';
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else if (i === quiz2Answers[index]) {
                        opt.classList.add('incorrect');
                    }
                });
                
                if (quiz2Answers[index] === q.correct) {
                    correct++;
                    feedback.className = 'feedback show correct';
                    feedback.innerHTML = `<strong>‚úì Benar!</strong> ${q.explanation}`;
                } else {
                    feedback.className = 'feedback show incorrect';
                    feedback.innerHTML = `<strong>‚úó Salah.</strong> ${q.explanation}`;
                }
            });
            
            const result = document.getElementById('quiz2Result');
            result.className = 'result show';
            result.innerHTML = `
                <h3>Hasil Kuis</h3>
                <div class="score-display">Skor Anda: ${correct}/10 (${(correct/10*100).toFixed(0)}%)</div>
                <p>${correct >= 8 ? 'Luar biasa! Anda menguasai reaksi penetralan.' : 
                     correct >= 6 ? 'Baik! Latihan lebih lanjut akan membantu.' : 
                     'Mari pelajari kembali konsep reaksi penetralan.'}</p>
                <button class="retry-btn" onclick="retryQuiz2()">üîÑ Ulangi Kuis</button>
            `;
            
            document.getElementById('submitQuiz2Btn').disabled = true;
            
            // Save result for student
            saveStudentResult('quiz2', correct, 10);
        }

        function retryQuiz2() {
            quiz2Answers = [];
            document.getElementById('quiz2Result').classList.remove('show');
            document.getElementById('submitQuiz2Btn').disabled = false;
            
            document.querySelectorAll('#quiz2Questions .question').forEach((question, index) => {
                const options = question.querySelectorAll('.option');
                const feedback = document.getElementById(`feedback2-${index}`);
                
                options.forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                    opt.style.pointerEvents = 'auto';
                });
                
                feedback.classList.remove('show');
            });
            
            window.scrollTo({top: document.getElementById('quiz2').offsetTop - 20, behavior: 'smooth'});
        }

        // Initialize Quiz 3 (Comprehensive)
        function initQuiz3() {
            const container = document.getElementById('quiz3Questions');
            container.innerHTML = quiz3Data.map((q, index) => {
                if (q.type === 'input') {
                    return `
                        <div class="question" data-index="${index}">
                            <h4>Soal ${index + 1}</h4>
                            <p>${q.question}</p>
                            <input type="text" id="quiz3-input-${index}" placeholder="Masukkan jawaban Anda">
                            <div id="feedback3-${index}" class="feedback"></div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="question" data-index="${index}">
                            <h4>Soal ${index + 1}</h4>
                            <p>${q.question}</p>
                            <div class="options">
                                ${q.options.map((opt, i) => `
                                    <div class="option" onclick="selectOption3(${index}, ${i})">${opt}</div>
                                `).join('')}
                            </div>
                            <div id="feedback3-${index}" class="feedback"></div>
                        </div>
                    `;
                }
            }).join('');
        }

        let quiz3Answers = [];
        function selectOption3(qIndex, optIndex) {
            const question = document.querySelectorAll('#quiz3Questions .question')[qIndex];
            const options = question.querySelectorAll('.option');
            
            options.forEach(opt => opt.classList.remove('selected'));
            options[optIndex].classList.add('selected');
            
            quiz3Answers[qIndex] = optIndex;
        }

        function submitQuiz3() {
            let correct = 0;
            let scoreByLevel = {C1: 0, C2: 0, C3: 0, C4: 0, C5: 0};
            let totalByLevel = {C1: 0, C2: 0, C3: 0, C4: 0, C5: 0};
            
            quiz3Data.forEach((q, index) => {
                totalByLevel[q.level]++;
                
                const question = document.querySelectorAll('#quiz3Questions .question')[index];
                const feedback = document.getElementById(`feedback3-${index}`);
                
                if (q.type === 'input') {
                    const input = document.getElementById(`quiz3-input-${index}`);
                    const userAnswer = input.value.trim();
                    input.disabled = true;
                    
                    const correctAnswers = q.correct.split(',').map(a => a.trim());
                    const isCorrect = correctAnswers.some(ans => 
                        Math.abs(parseFloat(userAnswer) - parseFloat(ans)) < 0.2
                    );
                    
                    if (isCorrect) {
                        correct++;
                        scoreByLevel[q.level]++;
                        feedback.className = 'feedback show correct';
                        feedback.innerHTML = `<strong>‚úì Benar!</strong> ${q.explanation}`;
                        input.style.borderColor = '#28a745';
                    } else {
                        feedback.className = 'feedback show incorrect';
                        feedback.innerHTML = `<strong>‚úó Salah.</strong> Jawaban yang benar: ${q.correct}. ${q.explanation}`;
                        input.style.borderColor = '#dc3545';
                    }
                } else {
                    const options = question.querySelectorAll('.option');
                    
                    options.forEach((opt, i) => {
                        opt.style.pointerEvents = 'none';
                        if (i === q.correct) {
                            opt.classList.add('correct');
                        } else if (i === quiz3Answers[index]) {
                            opt.classList.add('incorrect');
                        }
                    });
                    
                    if (quiz3Answers[index] === q.correct) {
                        correct++;
                        scoreByLevel[q.level]++;
                        feedback.className = 'feedback show correct';
                        feedback.innerHTML = `<strong>‚úì Benar!</strong> ${q.explanation}`;
                    } else {
                        feedback.className = 'feedback show incorrect';
                        feedback.innerHTML = `<strong>‚úó Salah.</strong> ${q.explanation}`;
                    }
                }
            });
            
            const result = document.getElementById('quiz3Result');
            result.className = 'result show';
            result.innerHTML = `
                <h3>Hasil Kuis Final</h3>
                <div class="score-display">Skor Total: ${correct}/20 (${(correct/20*100).toFixed(0)}%)</div>
                <p style="margin-top: 15px;">${
                    correct >= 17 ? 'Excellent! Anda menguasai materi dengan sangat baik.' : 
                    correct >= 14 ? 'Sangat baik! Pemahaman Anda sudah mendalam.' :
                    correct >= 10 ? 'Baik! Terus tingkatkan pemahaman Anda.' :
                    'Perlu belajar lebih intensif. Fokus pada konsep dasar terlebih dahulu.'
                }</p>
                <button class="retry-btn" onclick="retryQuiz3()">üîÑ Ulangi Kuis</button>
            `;
            
            document.getElementById('submitQuiz3Btn').disabled = true;
            
            // Save result for student
            saveStudentResult('quiz3', correct, 20);
        }

        function retryQuiz3() {
            quiz3Answers = [];
            document.getElementById('quiz3Result').classList.remove('show');
            document.getElementById('submitQuiz3Btn').disabled = false;
            
            document.querySelectorAll('#quiz3Questions .question').forEach((question, index) => {
                const feedback = document.getElementById(`feedback3-${index}`);
                const q = quiz3Data[index];
                
                if (q.type === 'input') {
                    const input = document.getElementById(`quiz3-input-${index}`);
                    input.value = '';
                    input.disabled = false;
                    input.style.borderColor = '#e0e0e0';
                } else {
                    const options = question.querySelectorAll('.option');
                    options.forEach(opt => {
                        opt.classList.remove('selected', 'correct', 'incorrect');
                        opt.style.pointerEvents = 'auto';
                    });
                }
                
                feedback.classList.remove('show');
            });
            
            window.scrollTo({top: document.getElementById('quiz3').offsetTop - 20, behavior: 'smooth'});
        }

        // Navigation functions
        function showQuiz(quizId) {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById(quizId).classList.add('active');
            
            if (quizId === 'quiz1' && document.getElementById('quiz1Questions').innerHTML === '') {
                initQuiz1();
            } else if (quizId === 'quiz2' && document.getElementById('quiz2Questions').innerHTML === '') {
                initQuiz2();
            } else if (quizId === 'quiz3' && document.getElementById('quiz3Questions').innerHTML === '') {
                initQuiz3();
            }
        }

        function backToMenu() {
            document.querySelectorAll('.quiz-content').forEach(quiz => {
                quiz.classList.remove('active');
            });
            document.getElementById('mainMenu').style.display = 'grid';
            window.scrollTo(0, 0);
        }

        function toggleHint(hintId) {
            const hint = document.getElementById(hintId);
            hint.classList.toggle('show');
        }

        // Initialize on load
        window.onload = function() {
            initStorage();
            console.log('Halaman Asesmen dan Refleksi siap digunakan!');
            
            // Hide main content initially
            document.getElementById('mainHeader').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'none';
        };
    </script>
</body>
</html>